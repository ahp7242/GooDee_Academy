<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta name="viewport"content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">
	<!-- Bootstrap core CSS -->
	<link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<!-- Custom styles for this template -->
	<link href="css/heroic-features.css" rel="stylesheet">
</head>
<title>CUSTOMER</title>
<style>
.box {
	height: 50px;
	width: 50px;
	text-align: center;
	border: 1px solid black;
	border-radius: 5px;
}

.center {
	text-align: center;
}

#seat {
	margin-left: auto;
	margin-right: auto;
}
#seat div{
	background-color: #EAEAEA;
}
</style>
</head>
<body>
	<div th:include="/part/customerNav::nav"></div>
	<div class="container center">
		<h1>CustomerSeat</h1>
		<div th:text="${franchisee.franchiseeName}"></div>
		<div>pc방 이미지<!-- <img class='card-img-top' src='http://placehold.it/500x325' alt=''> --></div>
		<table id="seat"></table>
	</div>
	<div th:include="/part/customerNav::copyright"></div>
</body>
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script th:inline="javascript">
 let seat = /*[[${seat}]]*/
 //console.log(seat);
 let html = "";
 let rowMax = 0;
 let colsMax = 0;
 
 $(seat).each(function(index,item){
	 //seat값을 검사하여 row값의 최대값을 rowMax에 저장
	 if(item.seatRow > rowMax){
		 rowMax = item.seatRow;
	 }
	//seat값을 검사하여 cols값의 최대값을 colsMax에 저장
	 if(item.seatCols > colsMax){
		 colsMax = item.seatCols
	 }
 })
 //console.log(rowMax)
 //console.log(colsMax)
 
 //좌석 표시중 마지막줄에 1줄 더하여 출력(pc방 길)
 for(let row=1; row<=rowMax+1; row++){
	 html += "<tr id='"+row+"'>"
	 
	 for(let cols=1; cols<=colsMax; cols++){
		 html += "<td id='"+cols+"'>"
		 html += "<div class='box'></div>";
		 html += "</td>";
	 }
	 
	 html += "</tr>"
 }
 $("#seat").html(html);
 
$(document).ready(function(){
		$("#seat tr td").each(function(index1,item1){
			//console.log($(this).closest('tr').attr('id'))
			let $this = $(this)
			let trId = $this.closest('tr').attr('id')
			let tdId = $this.closest('td').attr('id')
			/* console.log("tr",trId)
			console.log("td",tdId) */
			$(seat).each(function(index2,item2){
				if(trId == item2.seatRow && tdId == item2.seatCols){
					/* console.log(item2.seatNo) */
					$this.children().append("pc"+item2.seatNo)
					console.log(item2)
					let use = item2.seatUse
					switch(use){
						case "Y":
							$this.children().css("background-color","#B5B2FF");
							$this.children().append("<br>사용중");
							break;
						case "N":
							$this.children().css("background-color","#A0BAED");
							$this.children().append("<br>빈자리");
							break;
					}
				}
				
			})
		})
	})

</script>
</html>